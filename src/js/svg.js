(function(e,t){"use strict";function i(e){e=e.split(" ");var t={};var n=e.length;var r=[];while(n--){if(!t.hasOwnProperty(e[n])){t[e[n]]=1;r.unshift(e[n])}}return r.join(" ")}var n=e.location.protocol==="file:";var r=t.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1");var s=Array.prototype.forEach||function(e,t){if(this===void 0||this===null||typeof e!=="function"){throw new TypeError}var n,r=this.length>>>0;for(n=0;n<r;++n){if(n in this){e.call(t,this[n],n,this)}}};var o={};var u=0;var a=[];var f=[];var l={};var c=function(e){return e.cloneNode(true)};var h=function(e,t){f[e]=f[e]||[];f[e].push(t)};var p=function(e){for(var t=0,n=f[e].length;t<n;t++){(function(t){setTimeout(function(){f[e][t](c(o[e]))},0)})(t)}};var d=function(t,r){if(o[t]!==undefined){if(o[t]instanceof SVGSVGElement){r(c(o[t]))}else{h(t,r)}}else{if(!e.XMLHttpRequest){r("Browser does not support XMLHttpRequest");return false}o[t]={};h(t,r);var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===4){if(i.status===404||i.responseXML===null){r("Unable to load SVG file: "+t);if(n)r("Note: SVG injection ajax calls do not work locally without adjusting security setting in your browser. Or consider using a local webserver.");r();return false}if(i.status===200||n&&i.status===0){if(i.responseXML instanceof Document){o[t]=i.responseXML.documentElement}else if(DOMParser&&DOMParser instanceof Function){var e;try{var s=new DOMParser;e=s.parseFromString(i.responseText,"text/xml")}catch(u){e=undefined}if(!e||e.getElementsByTagName("parsererror").length){r("Unable to parse SVG file: "+t);return false}else{o[t]=e.documentElement}}p(t)}else{r("There was a problem injecting the SVG: "+i.status+" "+i.statusText);return false}}};i.open("GET",t);if(i.overrideMimeType)i.overrideMimeType("text/xml");i.send()}};var v=function(t,n,o,f){var c=t.getAttribute("data-src")||t.getAttribute("src");if(!/\.svg/i.test(c)){f("Attempted to inject a file with a non-svg extension: "+c);return}if(!r){var h=t.getAttribute("data-fallback")||t.getAttribute("data-png");if(h){t.setAttribute("src",h);f(null)}else if(o){t.setAttribute("src",o+"/"+c.split("/").pop().replace(".svg",".png"));f(null)}else{f("This browser does not support SVG and no PNG fallback was defined.")}return}if(a.indexOf(t)!==-1){return}a.push(t);t.setAttribute("src","");d(c,function(r){if(typeof r==="undefined"||typeof r==="string"){f(r);return false}var o=t.getAttribute("id");if(o){r.setAttribute("id",o)}var h=t.getAttribute("title");if(h){r.setAttribute("title",h)}var p=[].concat(r.getAttribute("class")||[],"injected-svg",t.getAttribute("class")||[]).join(" ");r.setAttribute("class",i(p));var d=t.getAttribute("style");if(d){r.setAttribute("style",d)}var v=[].filter.call(t.attributes,function(e){return/^data-\w[\w\-]*$/.test(e.name)});s.call(v,function(e){if(e.name&&e.value){r.setAttribute(e.name,e.value)}});var m=r.querySelectorAll("defs clipPath[id]");var g;for(var y=0,b=m.length;y<b;y++){g=m[y].id+"-"+u;var w=r.querySelectorAll('[clip-path*="'+m[y].id+'"]');for(var E=0,S=w.length;E<S;E++){w[E].setAttribute("clip-path","url(#"+g+")")}m[y].id=g}var x=r.querySelectorAll("defs mask[id]");var T;for(var N=0,C=x.length;N<C;N++){T=x[N].id+"-"+u;var k=r.querySelectorAll('[mask*="'+x[N].id+'"]');for(var L=0,A=k.length;L<A;L++){k[L].setAttribute("mask","url(#"+T+")")}x[N].id=T}r.removeAttribute("xmlns:a");var O=r.querySelectorAll("script");var M=[];var _,D;for(var P=0,H=O.length;P<H;P++){D=O[P].getAttribute("type");if(!D||D==="application/ecmascript"||D==="application/javascript"){_=O[P].innerText||O[P].textContent;M.push(_);r.removeChild(O[P])}}if(M.length>0&&(n==="always"||n==="once"&&!l[c])){for(var B=0,j=M.length;B<j;B++){(new Function(M[B]))(e)}l[c]=true}t.parentNode.replaceChild(r,t);delete a[a.indexOf(t)];t=null;u++;f(r)})};var m=function(e,t,n){t=t||{};var r=t.evalScripts||"always";var i=t.pngFallback||false;var o=t.each;if(e.length!==undefined){var u=0;s.call(e,function(t){v(t,r,i,function(t){if(o&&typeof o==="function")o(t);if(n&&e.length===++u)n(u)})})}else{if(e){v(e,r,i,function(t){if(o&&typeof o==="function")o(t);if(n)n(1);e=null})}else{if(n)n(0)}}};if(typeof module==="object"&&typeof module.exports==="object"){module.exports=exports=m}else if(typeof define==="function"&&define.amd){define(function(){return m})}else if(typeof e==="object"){e.SVGInjector=m}})(window,document)